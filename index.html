<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Echo Speak Text Entry</title>
    <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.8/css/mdb.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/codemirror.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/theme/material.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/codemirror.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/mode/simple.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/xml/xml.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/closetag.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/addon/edit/matchtags.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/mode/htmlmixed/htmlmixed.min.js"></script>
    <style>
        form div {
            margin-bottom: 0.5em;
            margin: 0 auto;
        }
        
        .form-control {
            font-size: 0.7rem;
        }
        
        button.btn.btn-info.btn-block.my-4 {
            max-width: 200px;
            text-align: center;
        }
        
        .ssml-buttons {
            font-size: .8rem;
            margin-bottom: 5px;
            text-decoration: none;
        }
        
        .ssml-buttons,
        h3 {
            font-size: 0.9rem;
            text-decoration: underline;
        }
        
        .ssml-buttons,
        input {
            font-size: 0.9rem;
            text-decoration: none;
        }
        
        .ssml-button {
            font-weight: normal;
            margin-left: 5px;
            margin-bottom: 5px;
            cursor: pointer;
            border: 0.5px solid #b1a8a8;
            border-radius: 7px;
            padding: 3px;
            background-color: #EEE;
            -webkit-appearance: none;
            -moz-appearance: none
        }
        
        .ssml-button:hover {
            background-color: #AAA
        }
        
        .ssml-button:first-child {
            margin-left: 0
        }
        
        .no-submit {
            cursor: text
        }
    </style>
</head>

<body class="m-2">
    <div class="p-3"><button type="button" class="close" aria-label="Close" onclick="window.open('','_parent',''); window.close();"><span aria-hidden="true">×</span></button></div>
    <div class="w-100 pt-4">
        <form>
            <div class="container px-0">
                <div class="text-center">
                    <p id="inputTitle" class="h5 mb-0">Text Field Entry</p>
                    <p class="mt-1 mb-2 text-center">Response Designer</p>
                </div>
                <div class="px-0">
                    <textarea id="editor"></textarea>
                    <div class="text-center blue-text"><small>Each line item represents a single response. Multiple lines will trigger a random selection.</small></div>
                    <div class="d-flex justify-content-center">
                        <button id="newLineBtn" style="border-radius: 50px !important;" class="btn btn-sm btn-outline-info px-1 my-2 mx-3" type="button"><i class="fas fa-plus mr-1"></i>Add New Response Line</button>
                        <button style="border-radius: 50px !important;" class="btn btn-sm btn-info my-2" type="submit"><i class="fa fa-save mr-1"></i>Submit Responses</button>
                    </div>
                </div>
                <div class="row mt-2 mx-auto">
                    <div class="px-2 col-12">
                        <div class="card my-3 mx-0">
                            <h5 class="card-header px-2 py-0"><i class="fas fa-info px-2 my-auto"></i>Builder Items</h5>
                            <div class="card-body py-0 px-2 mx-0">
                                <div class="text-center orange-text mt-0 mb-2">
                                    <small>Select a line item and tap on an item to insert or replace the item in the text.</small>
                                </div>
                                <div class="p-1 mx-auto">
                                    <div class="shortcuts-wrap" style="display: block;">
                                        <div class="row">
                                            <div class="col-12">
                                                <div class="ssml-buttons">
                                                    <h3>Event Variables</h3>
                                                    <input class="ssml-button" type="button" unselectable="on" value="Type" data-ssml="evttype">
                                                    <input class="ssml-button" type="button" unselectable="on" value="Value" data-ssml="evtvalue">
                                                    <input class="ssml-button" type="button" unselectable="on" value="DeviceName" data-ssml="evtname">
                                                    <input class="ssml-button" type="button" unselectable="on" value="Date" data-ssml="evtdate">
                                                    <input class="ssml-button" type="button" unselectable="on" value="Time" data-ssml="evttime">
                                                    <input class="ssml-button" type="button" unselectable="on" value="Date/Time" data-ssml="evtdatetime">
                                                    <input class="ssml-button" type="button" unselectable="on" value="Duration" data-ssml="evtduration">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="my-3">
                                        <small id="inputDesc">Description goes here.</small>
                                    </div>
                                </div>
                                <hr class="mb-1 mx-auto" style="background-color: #696969; width: 100%;">
                                <div class="p-1 mx-auto">
                                    <h4>SSML Markup Items</h4>
                                    <div class="shortcuts-wrap" style="display: block;">
                                        <div class="row">
                                            <div class="col-6">
                                                <div class="ssml-buttons">
                                                    <h3>BREAK</h3><input class="ssml-button" type="button" unselectable="on" value="50ms" data-ssml="break"><input class="ssml-button" type="button" unselectable="on" value="200ms" data-ssml="break"><input class="ssml-button"
                                                        type="button" unselectable="on" value="500ms" data-ssml="break"><input class="ssml-button" type="button" unselectable="on" value="800ms" data-ssml="break"><input class="ssml-button" type="button" unselectable="on"
                                                        value="1s" data-ssml="break"><input class="ssml-button" type="button" unselectable="on" value="2s" data-ssml="break">
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="ssml-buttons">
                                                    <h3>EMPHASIS</h3><input class="ssml-button" type="button" unselectable="on" value="strong" data-ssml="emphasis"><input class="ssml-button" type="button" unselectable="on" value="reduced" data-ssml="emphasis">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6">
                                                <div class="ssml-buttons">
                                                    <h3>PITCH</h3><input class="ssml-button" type="button" unselectable="on" value="x-low" data-ssml="pitch"><input class="ssml-button" type="button" unselectable="on" value="low" data-ssml="pitch"><input class="ssml-button"
                                                        type="button" unselectable="on" value="medium" data-ssml="pitch"><input class="ssml-button" type="button" unselectable="on" value="high" data-ssml="pitch"><input class="ssml-button" type="button" unselectable="on"
                                                        value="x-high" data-ssml="pitch">
                                                </div>
                                            </div>
                                            <div class="col-6 px-2">
                                                <div class="card-body ssml-buttons px-0 pb-0 pt-1">
                                                    <h3>RATE</h3><input class="ssml-button" type="button" unselectable="on" value="x-slow" data-ssml="rate"><input class="ssml-button" type="button" unselectable="on" value="slow" data-ssml="rate"><input class="ssml-button"
                                                        type="button" unselectable="on" value="medium" data-ssml="rate"><input class="ssml-button" type="button" unselectable="on" value="fast" data-ssml="rate"><input class="ssml-button" type="button" unselectable="on"
                                                        value="x-fast" data-ssml="rate">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6 px-2">
                                                <div class="card-body ssml-buttons px-0 pb-0 pt-1">
                                                    <h3>VOLUME</h3><input class="ssml-button" type="button" unselectable="on" value="silent" data-ssml="volume"><input class="ssml-button" type="button" unselectable="on" value="x-soft" data-ssml="volume">
                                                    <input class="ssml-button" type="button" unselectable="on" value="soft" data-ssml="volume"><input class="ssml-button" type="button" unselectable="on" value="medium" data-ssml="volume"><input class="ssml-button"
                                                        type="button" unselectable="on" value="loud" data-ssml="volume"><input class="ssml-button" type="button" unselectable="on" value="x-loud" data-ssml="volume">
                                                </div>
                                            </div>
                                            <div class="col-6 px-2">
                                                <div class="card-body ssml-buttons px-0 pb-0 pt-1">
                                                    <h3>WHISPER</h3><input class="ssml-button" type="button" unselectable="on" value="whisper" data-ssml="whisper">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-6 px-2">
                                                <div class="card-body ssml-buttons px-0 pb-0 pt-1">
                                                    <h3>VOICE</h3>
                                                    <select class="browser-default custom-select custom-select-sm mb-2" id="voices">
                                                                                <option value="Naja" class="x-option ember-view">Danish (F) - Naja</option>
                                                                                <option value="Mads" class="x-option ember-view">Danish (M) - Mads</option>
                                                                                <option value="Lotte" class="x-option ember-view">Dutch (F) - Lotte</option>
                                                                                <option value="Ruben" class="x-option ember-view">Dutch (M) - Ruben</option>
                                                                                <option value="Nicole" class="x-option ember-view">English, Australian (F) - Nicole</option>
                                                                                <option value="Russell" class="x-option ember-view">English, Australian (M) - Russell</option>
                                                                                <option value="Amy" class="x-option ember-view">English, British (F) - Amy</option>
                                                                                <option value="Emma" class="x-option ember-view">English, British (F) - Emma</option>
                                                                                <option value="Brian" class="x-option ember-view">English, British (M) - Brian</option>
                                                                                <option value="Raveena" class="x-option ember-view">English, Indian (F) - Raveena</option>
                                                                                <option value="Aditi" class="x-option ember-view">English, Indian (F) - Aditi</option>
                                                                                <option value="Ivy" class="x-option ember-view">English, US (F) - Ivy</option>
                                                                                <option value="Joanna" class="x-option ember-view">English, US (F) - Joanna</option>
                                                                                <option value="Kendra" class="x-option ember-view">English, US (F) - Kendra</option>
                                                                                <option value="Kimberly" class="x-option ember-view">English, US (F) - Kimberly</option>
                                                                                <option value="Salli" class="x-option ember-view">English, US (F) - Salli</option>
                                                                                <option value="Joey" class="x-option ember-view">English, US (M) - Joey</option>
                                                                                <option value="Justin" class="x-option ember-view">English, US (M) - Justin</option>
                                                                                <option value="Matthew" class="x-option ember-view">English, US (M) - Matthew</option>
                                                                                <option value="Geraint" class="x-option ember-view">English, Welsh (M) - Geraint</option>
                                                                                <option value="Celine" class="x-option ember-view">French (F) - Céline</option>
                                                                                <option value="Lea" class="x-option ember-view">French (F) - Léa</option>
                                                                                <option value="Mathieu" class="x-option ember-view">French (M) - Mathieu</option>
                                                                                <option value="Chantal" class="x-option ember-view">French, Canadian (F) - Chantal</option>
                                                                                <option value="Marlene" class="x-option ember-view">German (F) - Marlene</option>
                                                                                <option value="Vicki" class="x-option ember-view">German (F) - Vicki</option>
                                                                                <option value="Hans" class="x-option ember-view">German (M) - Hans</option>
                                                                                <option value="Aditi" class="x-option ember-view">Hindi (F) - Aditi</option>
                                                                                <option value="Dóra" class="x-option ember-view">Icelandic (F) - Dóra</option>
                                                                                <option value="Karl" class="x-option ember-view">Icelandic (M) - Karl</option>
                                                                                <option value="Carla" class="x-option ember-view">Italian (F) - Carla</option>
                                                                                <option value="Giorgio" class="x-option ember-view">Italian (M) - Giorgio</option>
                                                                                <option value="Takumi" class="x-option ember-view">Japanese (M) - Takumi</option>
                                                                                <option value="Mizuki" class="x-option ember-view">Japanese (F) - Mizuki</option>
                                                                                <option value="Seoyeon" class="x-option ember-view">Korean (F) - Seoyeon</option>
                                                                                <option value="Liv" class="x-option ember-view">Norwegian (F) - Liv</option>
                                                                                <option value="Ewa" class="x-option ember-view">Polish (F) - Ewa</option>
                                                                                <option value="Maja" class="x-option ember-view">Polish (F) - Maja</option>
                                                                                <option value="Jacek" class="x-option ember-view">Polish (M) - Jacek</option>
                                                                                <option value="Jan" class="x-option ember-view">Polish (M) - Jan</option>
                                                                                <option value="Vitoria" class="x-option ember-view">Portugese, Brazilian (F) - Vitória</option>
                                                                                <option value="Ricardo" class="x-option ember-view">Portugese, Brazilian (M) - Ricardo</option>
                                                                                <option value="Ines" class="x-option ember-view">Portugese, European (F) - Inês</option>
                                                                                <option value="Cristiano" class="x-option ember-view">Portugese, European (M) - Cristiano</option>
                                                                                <option value="Carmen" class="x-option ember-view">Romanian (F) - Carmen</option>
                                                                                <option value="Tatyana" class="x-option ember-view">Russian (F) - Tatyana</option>
                                                                                <option value="Maxim" class="x-option ember-view">Russian (M) - Maxim</option>
                                                                                <option value="Conchita" class="x-option ember-view">Spanish, European (F) - Conchita</option>
                                                                                <option value="Enrique" class="x-option ember-view">Spanish, European (M) - Enrique</option>
                                                                                <option value="Penélope" class="x-option ember-view">Spanish, US (F) - Penélope</option>
                                                                                <option value="Miguel" class="x-option ember-view">Spanish, US (M) - Miguel</option>
                                                                                <option value="Astrid" class="x-option ember-view">Swedish (F) - Astrid</option>
                                                                                <option value="Filiz" class="x-option ember-view">Turkish (F) - Filiz</option>
                                                                                <option value="Gwyneth" class="x-option ember-view">Welsh (F) - Gwyneth</option>
                                                                            </select>
                                                    <input class="ssml-button" type="button" unselectable="on" value="Add Voice" data-ssml="voice">
                                                </div>
                                            </div>
                                            <div class="col-6 px-2">
                                                <div class="card-body ssml-buttons px-0 pb-0 pt-1">
                                                    <h3>SAY-AS</h3><input class="ssml-button" type="button" unselectable="on" value="number" data-ssml="say-as"><input class="ssml-button" type="button" unselectable="on" value="spell-out" data-ssml="say-as">
                                                    <input class="ssml-button" type="button" unselectable="on" value="ordinal" data-ssml="say-as"><input class="ssml-button" type="button" unselectable="on" value="digits" data-ssml="say-as"><input class="ssml-button"
                                                        type="button" unselectable="on" value="date" data-ssml="say-as"><input class="ssml-button" type="button" unselectable="on" value="time" data-ssml="say-as"><input class="ssml-button" type="button" unselectable="on"
                                                        value="speechcon" data-ssml="say-as">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <hr class="mb-1 mx-auto" style="background-color: #696969; width: 100%;">
                                <div class="text-center align-text-top blue-text"><small>Speak tags will automatically be added to lines where SSML is inserted.</small></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.8/js/mdb.min.js"></script>
    <script>
        let inName = 'trig_contact_txt';
        let actId = '26a2ccdc-f404-4e8c-9314-8fe4b5cb009b'
        let rootUrl = 'https://graph.api.smartthings.com:443/api/smartapps/installations/533e121a-d7ba-4ac6-8102-575015956169/textEditor/26a2ccdc-f404-4e8c-9314-8fe4b5cb009b/trig_contact_txt?access_token=66965441-ea43-4397-b648-565981895013';
        let curText = '%name% %type% is %value%;The %name% %type% is now %value%;%name% %type% changed to %value%;%name% %type% has been %value% for %duration% seconds;';
        curText = curText == null || curText == 'null' || curText == '' ? '%name% %type% is now %value%' : curText
        let curTitle = '(Contact) Trigger Events';
        let curDesc = '<ul class="pl-3" style="list-style-type: bullet;"><li>Add custom responses for Contact trigger events.</li><li>Example: %name% %type% is now %value%</li><li>To make beep sounds use: <b>wop, wop, wop</b> (equals 3 beeps)</li></ul>';
        let selectedLineNum = undefined;
        toastr.options = {
            "closeButton": false,
            "debug": false,
            "newestOnTop": false,
            "progressBar": false,
            "positionClass": "toast-bottom-center",
            "preventDuplicates": true,
            "showDuration": 300,
            "hideDuration": 1000,
            "timeOut": 5000,
            "extendedTimeOut": 1000,
            "showEasing": "swing",
            "hideEasing": "linear",
            "showMethod": "fadeIn",
            "hideMethod": "fadeOut"
        }

        function cleanTxt(txt) {
            txt = txt.split(';').map(t => t.trim()).join(';')
            return txt.endsWith(';') ? txt.replace(/;([^;]*)$/, '$1') : txt
        }

        $(document).ready(function() {
            $('#inputTitle').text(curTitle);
            $('#inputDesc').html(curDesc);
            $('#editor').val(cleanTxt(curText));
            CodeMirror.defineSimpleMode("simplemode", {
                start: [{
                    regex: /%[a-z]+%/,
                    token: "variable"
                }, {
                    regex: /<[^>]+>/,
                    token: 'variable-3'
                }]
            });

            let editor = CodeMirror.fromTextArea(document.getElementById("editor"), {
                theme: 'material',
                mode: 'simplemode',
                lineNumbers: true,
                lineSeparator: ';',
                showCursorWhenSelecting: true,
                autoCloseTags: true,
                lineWrapping: false,
                autocorrect: false,
                autocapitalize: false,
                spellcheck: true
            });

            $('#newLineBtn').click((e) => {
                let doc = editor.getDoc();
                let cursor = doc.getCursor();
                let lineCnt = editor.lineCount();
                doc.replaceRange(';', CodeMirror.Pos(lineCnt - 1));
            });

            function updateInfo(instance, changeObj) {
                selectedLineNum = changeObj.to.line;
                // $('#lineCnt').text('Response Cnt: ' + changeObj.to.line);
            }

            editor.on("change", updateInfo);

            $('form').submit(function(e) {
                console.log('form submit...')
                e.preventDefault();
                let xmlhttp = new XMLHttpRequest();
                xmlhttp.open("POST", rootUrl);
                xmlhttp.onreadystatechange = () => {
                    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                        // console.log(xmlhttp.responseText);
                        toastr.success('Success!', "Text Submitted...")
                    }
                }
                xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
                console.log($('#editor').val());
                xmlhttp.send(JSON.stringify({
                    val: $('#editor').val(),
                    name: inName,
                    type: 'text'
                }));
            });

            function insertSsml(editor, str, sTags = true) {
                let doc = editor.getDoc();
                let cursor = doc.getCursor();
                let line = cursor.line;
                console.log(`lineTxt (${editor.getLine(line).length}): `, editor.getLine(line))
                if (editor.getSelection().length > 0) {
                    editor.replaceSelection(` ${str}`);
                } else {
                    doc.replaceRange(` ${str}`, {
                        line: line,
                        ch: cursor.ch
                    });
                }
                if (sTags) {
                    doc.replaceRange(editor.getLine(line).replace('<speak>', '').replace('</speak>', ''), {
                        line: line,
                        ch: 0
                    }, {
                        line: line,
                        ch: editor.getLine(line).length
                    });
                    doc.replaceRange('<speak>', {
                        line: line,
                        ch: 0
                    });
                    doc.replaceRange('</speak>', {
                        line: line,
                        ch: editor.getLine(line).length
                    });
                }
            }

            $('.ssml-buttons input:not(.no-submit)').click(function() {
                let ssml = $(this).data('ssml');
                let value = $(this).val();
                var selected = editor.getSelection();
                var replace = (selected == '') ? 'REPLACE_THIS_TEXT' : selected;
                switch (ssml) {
                    case 'break':
                        insertSsml(editor, `<break time="${value}"/>`);
                        break;
                    case 'emphasis':
                        insertSsml(editor, `<emphasis level="${value}">${replace}</emphasis>`);
                        break;
                    case 'pitch':
                    case 'rate':
                    case 'volume':
                        insertSsml(editor, `<prosody ${ssml}="${value}">${replace}</prosody>`);
                        break;
                    case 'voice':
                        insertSsml(editor, `<voice name="${($('#voices').val() != '') ? $('#voices').val() : 'Ivy'}">${replace}</voice>`);
                        break;
                    case 'audio':
                        insertSsml(editor, `<audio src="${($('#audio').val() != '') ? $('#audio').val() : 'https://s3.amazonaws.com/ask-soundlibrary/transportation/amzn_sfx_car_accelerate_01.mp3'}"/>`);
                        break;
                    case 'sub':
                        insertSsml(editor, `<sub alias="${($('#alias').val() != '') ? $('#alias').val() : 'magnesium'}">${replace}</sub>`);
                        break;
                    case 'say-as':
                        if (selected == '') {
                            switch (value) {
                                case 'number':
                                    replace = '1234';
                                    break;
                                case 'characters':
                                    replace = 'TEST';
                                    break;
                                case 'spell-out':
                                    replace = 'TEST';
                                    break;
                                case 'cardinal':
                                    replace = '1234';
                                    break;
                                case 'ordinal':
                                    replace = '5';
                                    break;
                                case 'digits':
                                    replace = '1234';
                                    break;
                                case 'fraction':
                                    replace = '1/5';
                                    break;
                                case 'unit':
                                    replace = 'USD10';
                                    break;
                                case 'date':
                                    replace = '01012019';
                                    break;
                                case 'time':
                                    // replace = '1'21"';
                                    break;
                                case 'telephone':
                                    replace = '(541) 754-3010';
                                    break;
                                case 'address':
                                    replace = '711-2880 Nulla St., Mankato, Mississippi, 96522';
                                    break;
                                case 'expletive':
                                    replace = 'bad word';
                                    break;
                                case 'interjection':
                                    replace = 'boing';
                                    break;
                                case 'speechcon':
                                    replace = 'boing';
                                    break;
                                default:
                                    replace = 'REPLACE THIS TEXT';
                            }
                        }
                        insertSsml(editor, `<say-as interpret-as="${value}">${replace}</say-as>`)
                        break;
                    case 'whisper':
                        insertSsml(editor, `<amazon:effect name="whispered">${replace}</amazon:effect>`);
                        break;
                    case 'evttype':
                        insertSsml(editor, '%type%', false);
                        break;
                    case 'evtvalue':
                        insertSsml(editor, '%value%', false);
                        break;
                    case 'evtname':
                        insertSsml(editor, '%name%', false);
                        break;
                    case 'evtdate':
                        insertSsml(editor, '%date%', false);
                        break;
                    case 'evttime':
                        insertSsml(editor, '%time%', false);
                        break;
                    case 'evtdatetime':
                        insertSsml(editor, '%datetime%', false);
                        break;
                    case 'evtduration':
                        insertSsml(editor, '%duration%', false);
                        break;
                    default:
                        break;
                }
                return false
            });
        });
    </script>
</body>

</html>